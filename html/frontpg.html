<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <title>WeebDB</title>
    <!--Front Page Stylesheet-->
    <link rel="stylesheet" href="../style/front_pg_style.css" />
    <!--Navigation Bar Stylesheet-->
    <link rel="stylesheet" href="../style/navBar_style.css" />
    <!--Body Stylesheet-->
    <link rel="stylesheet" href="../style/body_style.css" />
    <link rel="stylesheet" href="../style/front_pg_style.css" />
    <link rel="icon" type="image/png" href="../img/Logo.png" />
  </head>
  <body class="body">
    <!--Nav bar-->
    <div class="logo">
      <a href="frontpg.html">
        <img src="../img/Logo.png" class="max-h-[20vh]" />
      </a>
    </div>
    <nav class="nav_bar items-center p-4">
      <div class="flex gap-4">
        <a href="../html/frontpg.html">Anime</a>
        <a href="../html/myList.html">List</a>
      </div>
      <div class="nav_right">
        <div class="nav_right_search flex">
          <input
            type="text"
            placeholder="Search"
            class="px-3 py-2 border rounded"
            id="searchBarItem"
            style="border-width: 0; outline: none; color: black"
            autocomplete="off"
          />
          <a
            href="#"
            class="pr-5 w-auto" 
            onclick="searchAnime()"
            style="background-color: transparent"
            ><img src="../img/magnifying_icon.png" class="h-10 self-center"
          /></a>
        </div>
        <a href="../html/signup.html" id="signupLogin"></a>
      </div>
    </nav>
    <!--Anime List-->
    <div class="carousel-wrapper">
      <div class="category-title">
        <h1>Popular Airing Anime</h1>
        <div class="category-separator"></div>
      </div>

      <button class="arrow left" onclick="moveLeft('track1')">&#10094;</button>
      <div class="carousel-track" id="track1"></div>
      <button class="arrow right" onclick="moveRight('track1')">
        &#10095;
      </button>
    </div>

    <div class="carousel-wrapper">
      <div class="category-title">
        <h1>Seasonal Anime</h1>
        <div class="category-separator"></div>
      </div>

      <button class="arrow left" onclick="moveLeft('track2')">&#10094;</button>
      <div class="carousel-track" id="track2"></div>
      <button class="arrow right" onclick="moveRight('track2')">
        &#10095;
      </button>
    </div>
    <!-- Remove this later
    <div class="carousel-wrapper">
      <div class="category-title">
        <h1>Popular Publishing Manga</h1>
        <div class="category-separator"></div>
      </div>

      <button class="arrow left" onclick="moveLeft('track3')">&#10094;</button>
      <div class="carousel-track" id="track3"></div>
      <button class="arrow right" onclick="moveRight('track3')">
        &#10095;
      </button>
    </div>
    -->
    <div class="carousel-wrapper hidden" id="recommendation-section">
      <div class="category-title">
        <h1 id="recommendation-title">Because you liked <span id="anime-name-placeholder"></span></h1>
        <div class="category-separator"></div>
      </div>
    
      <button class="arrow left" onclick="moveLeft('track4')">&#10094;</button>
      <div class="carousel-track" id="track4"></div> 
      <button class="arrow right" onclick="moveRight('track4')">&#10095;</button>
    </div>

    <script>
      const imagesPerView = 4;
      const imageWidth = 340 + 5; // image + margin

      const carouselState = {};

      function updateCarousel(trackId) {
        const track = document.getElementById(trackId);
        const totalImages = track.children.length;
        const maxIndex = Math.ceil(totalImages / imagesPerView) - 1;

        const currentIndex = carouselState[trackId] || 0;
        const distance = currentIndex * -imagesPerView * imageWidth;
        track.style.transform = `translateX(${distance}px)`;
      }

      function moveLeft(trackId) {
        const track = document.getElementById(trackId);
        const totalImages = track.children.length;
        const maxIndex = Math.ceil(totalImages / imagesPerView) - 1;

        carouselState[trackId] =
          ((carouselState[trackId] || 0) - 1 + maxIndex + 1) % (maxIndex + 1);
        updateCarousel(trackId);
      }

      function moveRight(trackId) {
        const track = document.getElementById(trackId);
        const totalImages = track.children.length;
        const maxIndex = Math.ceil(totalImages / imagesPerView) - 1;

        carouselState[trackId] =
          ((carouselState[trackId] || 0) + 1) % (maxIndex + 1);
        updateCarousel(trackId);
      }
    </script>
  </body>
  <script src="../script/navBar_script.js"></script>
  <script src="../script/ifLogin.js"></script>
  <script src="../script/frontpgImg.js"></script>
  <script src="../script/recommendation.js"></script>
</html>
